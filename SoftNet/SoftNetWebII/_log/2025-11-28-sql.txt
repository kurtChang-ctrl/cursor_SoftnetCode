09:34:44(0); 
select distinct 
    p.Code as Id, (cast(max(p.AuthRow) as char(1)) + cast((case max(p.FunCreate) when 1 then max(rp.FunCreate) else 0 end) as char(1)) + cast((case when max(p.FunRead)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunRead) else 1 end) as char(1)) + cast((case when max(p.FunUpdate)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunUpdate) else 1 end) as char(1)) + cast((case when max(p.FunDelete)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunDelete) else 1 end) as char(1)) + cast((case when max(p.FunPrint)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunPrint) else 1 end) as char(1)) + cast((case when max(p.FunExport)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunExport) else 1 end) as char(1)) + cast((case max(p.FunView) when 1 then max(rp.FunView) else 0 end) as char(1)) + cast((case when max(p.FunOther)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunOther) else 1 end) as char(1))) as Str
from XpRoleProg rp
join XpUserRole ur on rp.RoleId=ur.RoleId
join XpProg p on rp.ProgId=p.Id
where ur.UserId=@UserId
group by p.Code
(Alex)
09:35:14(0); Insert Into SoftNetSYSDB.[dbo].APS_NeedData (ServerId,Id,FactoryName,Apply_PP_Name,CalendarName,PartNO,NeedQTY,IsAdd_SafeQTY,NeedDate,BufferTime,NeedSource,CTNO,CTName) Values (@ServerId,@Id,@FactoryName,@Apply_PP_Name,@CalendarName,@PartNO,@NeedQTY,@IsAdd_SafeQTY,@NeedDate,@BufferTime,@NeedSource,@CTNO,@CTName)(01,Z011CPUT6MNN,大正科技,A10-R01-01_加工製程,2021行事曆,A10-R01-01,1,0,2025/11/29 0:0,8,,,)
10:02:57(0); 
select distinct 
    p.Code as Id, (cast(max(p.AuthRow) as char(1)) + cast((case max(p.FunCreate) when 1 then max(rp.FunCreate) else 0 end) as char(1)) + cast((case when max(p.FunRead)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunRead) else 1 end) as char(1)) + cast((case when max(p.FunUpdate)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunUpdate) else 1 end) as char(1)) + cast((case when max(p.FunDelete)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunDelete) else 1 end) as char(1)) + cast((case when max(p.FunPrint)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunPrint) else 1 end) as char(1)) + cast((case when max(p.FunExport)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunExport) else 1 end) as char(1)) + cast((case max(p.FunView) when 1 then max(rp.FunView) else 0 end) as char(1)) + cast((case when max(p.FunOther)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunOther) else 1 end) as char(1))) as Str
from XpRoleProg rp
join XpUserRole ur on rp.RoleId=ur.RoleId
join XpProg p on rp.ProgId=p.Id
where ur.UserId=@UserId
group by p.Code
(Alex)
10:04:22(0); 
select distinct 
    p.Code as Id, (cast(max(p.AuthRow) as char(1)) + cast((case max(p.FunCreate) when 1 then max(rp.FunCreate) else 0 end) as char(1)) + cast((case when max(p.FunRead)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunRead) else 1 end) as char(1)) + cast((case when max(p.FunUpdate)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunUpdate) else 1 end) as char(1)) + cast((case when max(p.FunDelete)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunDelete) else 1 end) as char(1)) + cast((case when max(p.FunPrint)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunPrint) else 1 end) as char(1)) + cast((case when max(p.FunExport)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunExport) else 1 end) as char(1)) + cast((case max(p.FunView) when 1 then max(rp.FunView) else 0 end) as char(1)) + cast((case when max(p.FunOther)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunOther) else 1 end) as char(1))) as Str
from XpRoleProg rp
join XpUserRole ur on rp.RoleId=ur.RoleId
join XpProg p on rp.ProgId=p.Id
where ur.UserId=@UserId
group by p.Code
(Alex)
10:06:19(0); 
select distinct 
    p.Code as Id, (cast(max(p.AuthRow) as char(1)) + cast((case max(p.FunCreate) when 1 then max(rp.FunCreate) else 0 end) as char(1)) + cast((case when max(p.FunRead)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunRead) else 1 end) as char(1)) + cast((case when max(p.FunUpdate)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunUpdate) else 1 end) as char(1)) + cast((case when max(p.FunDelete)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunDelete) else 1 end) as char(1)) + cast((case when max(p.FunPrint)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunPrint) else 1 end) as char(1)) + cast((case when max(p.FunExport)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunExport) else 1 end) as char(1)) + cast((case max(p.FunView) when 1 then max(rp.FunView) else 0 end) as char(1)) + cast((case when max(p.FunOther)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunOther) else 1 end) as char(1))) as Str
from XpRoleProg rp
join XpUserRole ur on rp.RoleId=ur.RoleId
join XpProg p on rp.ProgId=p.Id
where ur.UserId=@UserId
group by p.Code
(Alex)
10:07:16(0); 
select distinct 
    p.Code as Id, (cast(max(p.AuthRow) as char(1)) + cast((case max(p.FunCreate) when 1 then max(rp.FunCreate) else 0 end) as char(1)) + cast((case when max(p.FunRead)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunRead) else 1 end) as char(1)) + cast((case when max(p.FunUpdate)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunUpdate) else 1 end) as char(1)) + cast((case when max(p.FunDelete)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunDelete) else 1 end) as char(1)) + cast((case when max(p.FunPrint)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunPrint) else 1 end) as char(1)) + cast((case when max(p.FunExport)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunExport) else 1 end) as char(1)) + cast((case max(p.FunView) when 1 then max(rp.FunView) else 0 end) as char(1)) + cast((case when max(p.FunOther)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunOther) else 1 end) as char(1))) as Str
from XpRoleProg rp
join XpUserRole ur on rp.RoleId=ur.RoleId
join XpProg p on rp.ProgId=p.Id
where ur.UserId=@UserId
group by p.Code
(Alex)
10:10:20(0); 
select distinct 
    p.Code as Id, (cast(max(p.AuthRow) as char(1)) + cast((case max(p.FunCreate) when 1 then max(rp.FunCreate) else 0 end) as char(1)) + cast((case when max(p.FunRead)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunRead) else 1 end) as char(1)) + cast((case when max(p.FunUpdate)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunUpdate) else 1 end) as char(1)) + cast((case when max(p.FunDelete)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunDelete) else 1 end) as char(1)) + cast((case when max(p.FunPrint)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunPrint) else 1 end) as char(1)) + cast((case when max(p.FunExport)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunExport) else 1 end) as char(1)) + cast((case max(p.FunView) when 1 then max(rp.FunView) else 0 end) as char(1)) + cast((case when max(p.FunOther)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunOther) else 1 end) as char(1))) as Str
from XpRoleProg rp
join XpUserRole ur on rp.RoleId=ur.RoleId
join XpProg p on rp.ProgId=p.Id
where ur.UserId=@UserId
group by p.Code
(Alex)
10:13:48(0); 
select distinct 
    p.Code as Id, (cast(max(p.AuthRow) as char(1)) + cast((case max(p.FunCreate) when 1 then max(rp.FunCreate) else 0 end) as char(1)) + cast((case when max(p.FunRead)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunRead) else 1 end) as char(1)) + cast((case when max(p.FunUpdate)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunUpdate) else 1 end) as char(1)) + cast((case when max(p.FunDelete)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunDelete) else 1 end) as char(1)) + cast((case when max(p.FunPrint)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunPrint) else 1 end) as char(1)) + cast((case when max(p.FunExport)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunExport) else 1 end) as char(1)) + cast((case max(p.FunView) when 1 then max(rp.FunView) else 0 end) as char(1)) + cast((case when max(p.FunOther)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunOther) else 1 end) as char(1))) as Str
from XpRoleProg rp
join XpUserRole ur on rp.RoleId=ur.RoleId
join XpProg p on rp.ProgId=p.Id
where ur.UserId=@UserId
group by p.Code
(Alex)
10:15:54(0); 
select distinct 
    p.Code as Id, (cast(max(p.AuthRow) as char(1)) + cast((case max(p.FunCreate) when 1 then max(rp.FunCreate) else 0 end) as char(1)) + cast((case when max(p.FunRead)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunRead) else 1 end) as char(1)) + cast((case when max(p.FunUpdate)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunUpdate) else 1 end) as char(1)) + cast((case when max(p.FunDelete)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunDelete) else 1 end) as char(1)) + cast((case when max(p.FunPrint)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunPrint) else 1 end) as char(1)) + cast((case when max(p.FunExport)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunExport) else 1 end) as char(1)) + cast((case max(p.FunView) when 1 then max(rp.FunView) else 0 end) as char(1)) + cast((case when max(p.FunOther)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunOther) else 1 end) as char(1))) as Str
from XpRoleProg rp
join XpUserRole ur on rp.RoleId=ur.RoleId
join XpProg p on rp.ProgId=p.Id
where ur.UserId=@UserId
group by p.Code
(Alex)
11:47:23(0); 
select distinct 
    p.Code as Id, (cast(max(p.AuthRow) as char(1)) + cast((case max(p.FunCreate) when 1 then max(rp.FunCreate) else 0 end) as char(1)) + cast((case when max(p.FunRead)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunRead) else 1 end) as char(1)) + cast((case when max(p.FunUpdate)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunUpdate) else 1 end) as char(1)) + cast((case when max(p.FunDelete)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunDelete) else 1 end) as char(1)) + cast((case when max(p.FunPrint)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunPrint) else 1 end) as char(1)) + cast((case when max(p.FunExport)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunExport) else 1 end) as char(1)) + cast((case max(p.FunView) when 1 then max(rp.FunView) else 0 end) as char(1)) + cast((case when max(p.FunOther)=0 then 0 when max(p.AuthRow)=1 then max(rp.FunOther) else 1 end) as char(1))) as Str
from XpRoleProg rp
join XpUserRole ur on rp.RoleId=ur.RoleId
join XpProg p on rp.ProgId=p.Id
where ur.UserId=@UserId
group by p.Code
(Alex)
